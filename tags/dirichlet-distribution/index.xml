<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Dirichlet Distribution on Journeyman Modeler</title>
    <link>/tags/dirichlet-distribution/</link>
    <description>Recent content in Dirichlet Distribution on Journeyman Modeler</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 31 May 2020 00:00:00 +0000</lastBuildDate>
    
	    <atom:link href="/tags/dirichlet-distribution/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Deriving the Dirichlet Distribution from Gamma Distributed Variables</title>
      <link>/post/deriving-the-dirichlet-distribution-from-gamma-distributed-variables/</link>
      <pubDate>Sun, 31 May 2020 00:00:00 +0000</pubDate>
      
      <guid>/post/deriving-the-dirichlet-distribution-from-gamma-distributed-variables/</guid>
      <description>


&lt;p&gt;This post is a continuation of the post that constructs a &lt;a href=&#34;https://jmodeler.github.io/post/deriving-the-beta-distribution-from-gamma-distributed-variables/&#34;&gt;Beta distribution from Gamma distributed variables&lt;/a&gt;. We use the same parameterization of the Gamma Distribution as before, and set the rate parameter &lt;span class=&#34;math inline&#34;&gt;\(=1\)&lt;/span&gt; unless otherwise specified. In this post I prove that the following property holds:&lt;/p&gt;
&lt;p&gt;Given &lt;span class=&#34;math inline&#34;&gt;\(Z_i \sim Gamma(\alpha_i,1)\)&lt;/span&gt;, are IID, (&lt;span class=&#34;math inline&#34;&gt;\(\alpha_i &amp;gt; 0\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(1 \le i \le n\)&lt;/span&gt;) and I define the variables &lt;span class=&#34;math inline&#34;&gt;\(U_i = \frac{Z_i}{\sum\limits_{i=1}^{N} Z_i}\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(V = \sum\limits_{i=1}^{N} Z_i\)&lt;/span&gt;. Then:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\((U_1, U_2, \dots, U_N) \sim Dir(\alpha_1, \alpha_2, \dots, \alpha_N) = \frac{\Gamma(\sum \alpha_i)}{\Gamma(\alpha_1)\dots \Gamma(\alpha_N)} u_1^{\alpha_1-1}u_2^{\alpha_1-1}\dots u_N^{\alpha_N-1} = \frac{\Gamma(\sum \alpha_i)}{\Gamma(\alpha_1)\dots \Gamma(\alpha_N)} u_1^{\alpha_1-1}u_2^{\alpha_1-1}\dots (1-\sum\limits_{i=1}^{N-1}u_i)^{\alpha_N-1}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(V \sim Gamma(\sum\limits_{i=1}^{N} \alpha_i, 1)\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(U = (U_1, U_2, \dots, U_N)\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(V\)&lt;/span&gt; are independent&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;By construction, &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=1}^{N} U_i = 1\)&lt;/span&gt;. The &lt;span class=&#34;math inline&#34;&gt;\(N^{th}\)&lt;/span&gt; term is redundant (in the sense that it can be obtained from the remaining &lt;span class=&#34;math inline&#34;&gt;\((N-1)\)&lt;/span&gt; terms). I use the &lt;a href=&#34;http://andymiller.github.io/2015/08/09/integral-jacobian.html&#34;&gt;change of variables approach&lt;/a&gt; to find the joint distribution of &lt;span class=&#34;math inline&#34;&gt;\((U_1,U_2,\dots,U_{N-1}, V)\)&lt;/span&gt;. I represent the &lt;span class=&#34;math inline&#34;&gt;\(Z_i\)&lt;/span&gt;â€™s as functions of &lt;span class=&#34;math inline&#34;&gt;\(U_i\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(V\)&lt;/span&gt; to get:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:zureln2&#34; id=&#34;eq:zureln1&#34;&gt;\[\begin{align}
Z_i &amp;amp; =   U_i V &amp;amp;&amp;amp; 0 \le i \le N-1  \tag{1}\\ 
Z_N &amp;amp; =  (1-\sum_{i=1}^{N-1}U_i)V &amp;amp;&amp;amp;  \tag{2}
\end{align}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;By definition, the joint density of &lt;span class=&#34;math inline&#34;&gt;\((U_1,U_2,\dots,U_{N-1}, V)\)&lt;/span&gt; is given by:
&lt;span class=&#34;math display&#34; id=&#34;eq:chovn&#34;&gt;\[\begin{align}
f_{U_1,U_2,\dots,U_{N-1}, V}(u_1,u_2,\dots, u_{N-1}, v) &amp;amp;= f_{Z_1,\dots,Z_N}(z_1,\dots,z_N) |J_{(z_1,z_2,\dots,z_{N-1},z_N) \rightarrow (u_1,u_2,\dots, u_{N-1}, v)}| &amp;amp; \tag{3}
\end{align}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The Jacobian matrix is given by:
&lt;span class=&#34;math display&#34; id=&#34;eq:njaco&#34;&gt;\[\begin{align}
J_{(z_1,z_2,\dots,z_{N-1},z_N) \rightarrow (u_1,u_2,\dots, u_{N-1}, v)} = 
\begin{bmatrix} 
\frac{\partial z_1}{\partial u_1} &amp;amp; \frac{\partial z_1}{\partial u_2} &amp;amp; \dots &amp;amp; \frac{\partial z_1}{\partial u_{N-1}} &amp;amp; \frac{\partial z_1}{\partial v} \\ 
\frac{\partial z_2}{\partial u_1} &amp;amp; \frac{\partial z_2}{\partial u_2} &amp;amp; \dots &amp;amp; \frac{\partial z_2}{\partial u_{N-1}} &amp;amp; \frac{\partial z_2}{\partial v} \\
\vdots &amp;amp; \vdots &amp;amp; \ddots &amp;amp; \vdots &amp;amp; \vdots \\
\frac{\partial z_{N-1}}{\partial u_1} &amp;amp; \frac{\partial z_{N-1}}{\partial u_2} &amp;amp; \dots &amp;amp; \frac{\partial z_{N-1}}{\partial u_{N-1}} &amp;amp; \frac{\partial z_{N-1}}{\partial v} \\
\frac{\partial z_N}{\partial u_1} &amp;amp; \frac{\partial z_N}{\partial u_2} &amp;amp; \dots &amp;amp; \frac{\partial z_N}{\partial u_N} &amp;amp; \frac{\partial z_N}{\partial v} 
\end{bmatrix} \tag{4}
\end{align}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Given &lt;a href=&#34;#eq:zureln1&#34;&gt;(1)&lt;/a&gt; &amp;amp; &lt;a href=&#34;#eq:zureln2&#34;&gt;(2)&lt;/a&gt;, the partial derivatives in the Jacobian matrix  are given by&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:parzureln5&#34; id=&#34;eq:parzureln4&#34; id=&#34;eq:parzureln3&#34; id=&#34;eq:parzureln2&#34; id=&#34;eq:parzureln1&#34;&gt;\[\begin{alignat}{2}
\frac{\partial z_i}{\partial u_i} &amp;amp; =  v &amp;amp;&amp;amp; \quad 0 \le i \le N-1  \tag{5}\\
\frac{\partial z_i}{\partial u_j} &amp;amp; =  0 &amp;amp;&amp;amp; \quad j \neq i, 0 \le j \le N-1  \tag{6}\\
\frac{\partial z_i}{\partial v} &amp;amp; = u_i &amp;amp;&amp;amp; \quad 0 \le i \le N-1 \tag{7} \\
\frac{\partial z_N}{\partial u_i} &amp;amp; = -v &amp;amp;&amp;amp; \quad 0 \le i \le N-1 \tag{8} \\
\frac{\partial z_N}{\partial v} &amp;amp; = 1-\sum_{i=1}^{N-1} u_i  \tag{9}
\end{alignat}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Substituting &lt;a href=&#34;#eq:parzureln1&#34;&gt;(5)&lt;/a&gt;, &lt;a href=&#34;#eq:parzureln2&#34;&gt;(6)&lt;/a&gt;, &lt;a href=&#34;#eq:parzureln3&#34;&gt;(7)&lt;/a&gt;, &lt;a href=&#34;#eq:parzureln4&#34;&gt;(8)&lt;/a&gt; &amp;amp; &lt;a href=&#34;#eq:parzureln5&#34;&gt;(9)&lt;/a&gt; in &lt;a href=&#34;#eq:njaco&#34;&gt;(4)&lt;/a&gt;, we get
&lt;span class=&#34;math display&#34; id=&#34;eq:njaco1&#34;&gt;\[\begin{align}
J_{(z_1,z_2,\dots,z_{N-1},z_N) \rightarrow (u_1,u_2,\dots, u_{N-1}, v)} = 
\begin{bmatrix} 
v &amp;amp; 0 &amp;amp; \dots &amp;amp; 0 &amp;amp; u_1 \\ 
0 &amp;amp; v &amp;amp; \dots &amp;amp; 0 &amp;amp; u_2 \\
\vdots &amp;amp; \vdots &amp;amp; \ddots &amp;amp; \vdots &amp;amp; \vdots \\
0 &amp;amp; 0 &amp;amp; \dots &amp;amp; v &amp;amp; u_{N-1} \\
-v &amp;amp; -v &amp;amp; \dots &amp;amp; -v &amp;amp; 1-\sum_{i=1}^{N-1} u_i  
\end{bmatrix} \tag{10}
\end{align}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I need the determinant of the Jacobian matrix above. This can be computed easily after making a row transformation operation. Apply the transformation &lt;span class=&#34;math inline&#34;&gt;\(R_N \rightarrow R_N + \sum\limits_{i=1}^{N-1} R_i\)&lt;/span&gt; (where &lt;span class=&#34;math inline&#34;&gt;\(R_i\)&lt;/span&gt; is the &lt;span class=&#34;math inline&#34;&gt;\(i^{th}\)&lt;/span&gt; row of the determinant) to get:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:njacosimple&#34;&gt;\[\begin{align}
|J_{(z_1,z_2,\dots,z_{N-1},z_N) \rightarrow (u_1,u_2,\dots, u_{N-1}, v)}| = 
\begin{vmatrix} 
v &amp;amp; 0 &amp;amp; \dots &amp;amp; 0 &amp;amp; u_1 \\ 
0 &amp;amp; v &amp;amp; \dots &amp;amp; 0 &amp;amp; u_2 \\
\vdots &amp;amp; \vdots &amp;amp; \ddots &amp;amp; \vdots &amp;amp; \vdots \\
0 &amp;amp; 0 &amp;amp; \dots &amp;amp; v &amp;amp; u_{N-1} \\
0 &amp;amp; 0 &amp;amp; \dots &amp;amp; 0 &amp;amp; 1  
\end{vmatrix} = v^{N-1}  \tag{11}
\end{align}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Using result &lt;a href=&#34;#eq:njacosimple&#34;&gt;(11)&lt;/a&gt; in &lt;a href=&#34;#eq:chovn&#34;&gt;(3)&lt;/a&gt;, I get:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:nchovint&#34;&gt;\[\begin{align}
f_{U_1,U_2,\dots,U_{N-1}, V}(u_1,u_2,\dots, u_{N-1}, v) = f_{Z_1,Z_2,\dots,Z_{N-1},Z_N}(z_1,z_2,\dots,z_{N-1},z_N) v^{N-1} \tag{12}
\end{align}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Since &lt;span class=&#34;math inline&#34;&gt;\(Z_i\)&lt;/span&gt; are IID &lt;span class=&#34;math inline&#34;&gt;\(Gamma(\alpha_i,1)\)&lt;/span&gt; distributed:
&lt;span class=&#34;math display&#34; id=&#34;eq:ngamma&#34;&gt;\[\begin{align}
f_{Z_1,\dots,Z_N}(z_1,\dots,z_N) = \prod_{i=1}^{N}f_{Z_i}(z_i) = \prod_{i=1}^{N} \frac{1}{\Gamma(\alpha_i)} z_i^{\alpha_i - 1} e^{-z_i} = \left[ \prod_{i=1}^{N} \frac{1}{\Gamma(\alpha_i)} z_i^{\alpha_i - 1} \right] e^{-\sum\limits_{i=1}^{N}z_i} \tag{13}
\end{align}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Substituting &lt;a href=&#34;#eq:ngamma&#34;&gt;(13)&lt;/a&gt; into &lt;a href=&#34;#eq:nchovint&#34;&gt;(12)&lt;/a&gt;, and using the relations in &lt;a href=&#34;#eq:zureln1&#34;&gt;(1)&lt;/a&gt; &amp;amp; &lt;a href=&#34;#eq:zureln2&#34;&gt;(2)&lt;/a&gt;:
&lt;span class=&#34;math display&#34; id=&#34;eq:nchovint1&#34;&gt;\[\begin{align}
f_{U_1,\dots,U_{N-1}, V}(u_1,\dots, u_{N-1}, v)  =  &amp;amp; \left[ \prod_{i=1}^{N} \frac{1}{\Gamma(\alpha_i)} z_i^{\alpha_i - 1} \right] e^{-\sum\limits_{i=1}^{N}z_i} \cdot v^{N-1} &amp;amp; \nonumber \\
\implies f_{U_1,\dots,U_{N-1}, V}(u_1,\dots, u_{N-1}, v)  = &amp;amp; \left[ \prod_{i=1}^{N-1} \frac{1}{\Gamma(\alpha_i)} z_i^{\alpha_i - 1} \right] \frac{1}{\Gamma(\alpha_N)} z_N^{\alpha_N - 1} e^{-v}  v^{N-1} &amp;amp; \nonumber \\
\implies f_{U_1,\dots,U_{N-1}, V}(u_1,\dots, u_{N-1}, v)  = &amp;amp; \left[ \prod_{i=1}^{N-1} \frac{1}{\Gamma(\alpha_i)} (u_i v)^{\alpha_i - 1} \right] \frac{1}{\Gamma(\alpha_N)} (v(1-\sum\limits_{i=1}^{N-1}u_i))^{\alpha_N - 1} e^{-v}  v^{N-1} &amp;amp;  \tag{14}
\end{align}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Since &lt;span class=&#34;math inline&#34;&gt;\(U_N = 1 - \sum\limits_{i=1}^{N-1}U_i\)&lt;/span&gt;, I put this in &lt;a href=&#34;#eq:nchovint1&#34;&gt;(14)&lt;/a&gt; to get
&lt;span class=&#34;math display&#34;&gt;\[\begin{align}
 f_{U_1,\dots,U_{N-1}, V}(u_1,\dots, u_{N-1}, v) &amp;amp; = \left[ \prod_{i=1}^{N-1} \frac{1}{\Gamma(\alpha_i)} (u_i v)^{\alpha_i - 1} \right] \frac{1}{\Gamma(\alpha_N)} (u_N v)^{\alpha_N - 1} e^{-v}  v^{N-1} &amp;amp; \nonumber \\
\implies f_{U_1,\dots,U_{N-1}, V}(u_1,\dots, u_{N-1}, v) &amp;amp; = \left[ \prod_{i=1}^{N} \frac{1}{\Gamma(\alpha_i)} (u_i v)^{\alpha_i - 1} \right] e^{-v}  v^{N-1} &amp;amp; \nonumber \\
\implies f_{U_1,\dots,U_{N-1}, V}(u_1,\dots, u_{N-1}, v) &amp;amp; = \left[ \prod_{i=1}^{N} \frac{1}{\Gamma(\alpha_i)} (u_i)^{\alpha_i - 1} \right] v^{\left(\sum\limits_{i=1}^{N}\alpha_i-N \right)} e^{-v}  v^{N-1} &amp;amp; \nonumber \\
\implies f_{U_1,\dots,U_{N-1}, V}(u_1,\dots, u_{N-1}, v) &amp;amp; = \left[ \prod_{i=1}^{N} \frac{1}{\Gamma(\alpha_i)} (u_i)^{\alpha_i - 1} \right] v^{\left(\sum\limits_{i=1}^{N}\alpha_i-1 \right)} e^{-v}  &amp;amp; \nonumber 
\end{align}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{align}
\implies f_{U_1,\dots,U_{N-1}, V}(u_1,\dots, u_{N-1}, v) &amp;amp; =  \Gamma \left(\sum\limits_{i=1}^{N}\alpha_i \right) \left[ \prod_{i=1}^{N} \frac{1}{\Gamma(\alpha_i)} (u_i)^{\alpha_i - 1} \right] \frac{1}{\Gamma \left(\sum\limits_{i=1}^{N}\alpha_i \right)}v^{\left(\sum\limits_{i=1}^{N}\alpha_i-1 \right)} e^{-v}  &amp;amp; \nonumber \\
\implies f_{U_1,\dots,U_{N-1}, V}(u_1,\dots, u_{N-1}, v) &amp;amp; =  \frac{\Gamma \left(\sum\limits_{i=1}^{N}\alpha_i \right)}{\prod\limits_{i=1}^{N} \Gamma(\alpha_i)} \left[ \prod_{i=1}^{N} (u_i)^{\alpha_i - 1} \right] \frac{1}{\Gamma \left(\sum\limits_{i=1}^{N}\alpha_i \right)}v^{\left(\sum\limits_{i=1}^{N}\alpha_i-1 \right)} e^{-v}  &amp;amp; \nonumber \\
\implies f_{U_1,\dots,U_{N-1}, V}(u_1,\dots, u_{N-1}, v) &amp;amp; =  Dir(\alpha_1,\alpha_2, \dots, \alpha_N) \cdot Gamma(\sum\limits_{i=1}^{N}\alpha_i, 1)  &amp;amp; 
\end{align}\]&lt;/span&gt;

Which establishes the following:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\((U_1,U_2,\dots,U_{N-1}, U_{N}) \sim Dir(\alpha_1,\alpha_2, \dots, \alpha_N)\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(V \sim Gamma(\sum\limits_{i=1}^{N}\alpha_i,1)\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(U = (U_1,U_2,\dots,U_{N-1}, U_{N})\)&lt;/span&gt; &amp;amp; &lt;span class=&#34;math inline&#34;&gt;\(V\)&lt;/span&gt; are independent&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This completes the proof.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
